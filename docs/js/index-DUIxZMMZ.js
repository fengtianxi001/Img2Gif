import{i as h,q as v,s as g,x as k,d as I,o as y,a as w,k as m,u as c,I as R,b as d,t as f,e as $,y as M}from"./vendor-BCqAv1Ex.js";import{F as p,r as U,c as b,_ as z}from"./common-C92A8nWI.js";import{_ as x}from"./index-BqKLToUc.js";const l={getId(){return p.getId()},chooser(){return p.chooser("image/*")},getDpi(a){return new Promise(t=>{const o=new Image;o.onload=()=>t({width:o.width,height:o.height}),o.src=a})}};function D(){const a=h([]),t=h([]);return{items:a,selected:t,onAddItem:async()=>{const n=await l.chooser(),i=async e=>({id:l.getId(),url:URL.createObjectURL(e),name:e.name,size:p.formatSize(e.size),type:e.type.split("/")[1],dpi:await l.getDpi(URL.createObjectURL(e)),file:e,lastModified:k(e.lastModified).format("YYYY-MM-DD HH:mm:ss")}),r=n.map(e=>i(e)),s=await Promise.all(r);a.value.push(...s),v.success(`成功导入 ${s.length} 张图片`)},onRemoveItems:async n=>{const i=a.value.filter(({id:e})=>n.includes(e)).map(({name:e})=>e);if(!await U(i))return;const s=g.remove(a.value,({id:e})=>n.includes(e));g.remove(t.value,e=>n.includes(e)),v.success(`成功移除 ${s.length} 张图片`)},onConvertItems:async()=>{await b("image",a.value)}}}const L={class:"image-info"},A={class:"info-base"},B={class:"info-name"},Y={class:"info-size"},j=I({__name:"profile",props:{data:{}},setup(a){return(t,o)=>(y(),w("div",L,[m(c(R),{src:t.data.url,width:50,height:34,fit:"cover"},null,8,["src"]),d("div",A,[d("div",B,f(t.data.name),1),d("div",Y,f(t.data.size),1)])]))}}),P=x(j,[["__scopeId","data-v-d08ce036"]]),S={class:"page"},E=I({__name:"index",setup(a){const{selected:t,items:o,onAddItem:u,onRemoveItems:_,onConvertItems:n}=D(),i=$(()=>[{text:"导入图片",type:"primary",onClick:()=>u()},{text:"批量删除",type:"primary",onClick:()=>_(t.value)},{text:"开始转化",type:"primary",onClick:()=>n()}]),r=[{title:"基础信息",dataIndex:"name",width:400,render:({record:s})=>m(P,{data:s},null)},{title:"图片分辨率",dataIndex:"dpi",align:"center",render:({record:s})=>`${s.dpi.width} * ${s.dpi.height}`},{title:"图片类型",dataIndex:"type",align:"center"},{title:"最后编辑时间",dataIndex:"lastModified",align:"center"}];return(s,e)=>(y(),w("div",S,[m(c(z),{selected:c(t),"onUpdate:selected":e[0]||(e[0]=C=>M(t)?t.value=C:null),options:{rowSelection:{type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}},data:c(o),operates:i.value,columns:r},null,8,["selected","data","operates"])]))}}),O=x(E,[["__scopeId","data-v-d21dd48e"]]);export{O as default};
