import{i as p,x as b,q as v,s as f,d as y,o as I,a as w,b as l,t as _,e as C,k as h,u,y as M}from"./vendor-BCqAv1Ex.js";import{F as R,r as k,c as B,_ as D}from"./common-C92A8nWI.js";import{V as g,c as V}from"./video-B7JAIyFR.js";import{_ as x}from"./index-BqKLToUc.js";function $(){const o=p([]),a=p([]);return{items:o,selected:a,onAddItem:async()=>{const s=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}),n=[],d=new MediaRecorder(s,{mimeType:"video/mp4"});d.ondataavailable=e=>{n.push(e.data)},d.start(100),d.onstop=async()=>{const e=new Blob(n),t=URL.createObjectURL(e),c=await g.getVideoObject(t);o.value.push({id:g.getId(),url:t,name:"录像"+new Date().getTime(),size:R.formatSize(e.size),type:"mp4",dpi:{width:c.videoWidth,height:c.videoHeight},file:e,duration:parseInt(c.duration*10+"")/10,lastModified:b().format("YYYY-MM-DD HH:mm:ss")}),v.success("录像导入成功")}},onRemoveItems:async s=>{const n=o.value.filter(({id:t})=>s.includes(t)).map(({name:t})=>t);if(!await k(n))return;const e=f.remove(o.value,({id:t})=>s.includes(t));f.remove(a.value,t=>s.includes(t)),v.success(`成功移除 ${e.length} 个视频`)},onConvertItems:async()=>{const s=o.value.filter(({id:n})=>a.value.includes(n));await B("video",s)}}}const z={class:"image-info"},U=["src"],S={class:"info-base"},Y={class:"info-name"},j={class:"info-size"},A=y({__name:"profile",props:{data:{}},setup(o){const a=o,r=()=>{V(a.data.url)};return(i,m)=>(I(),w("div",z,[l("video",{fit:"cover",src:i.data.url,width:50,height:34,onClick:r},null,8,U),l("div",S,[l("div",Y,_(i.data.name),1),l("div",j,_(i.data.size),1)])]))}}),H=x(A,[["__scopeId","data-v-5cb7ca1d"]]),P={class:"page"},E=y({__name:"index",setup(o){const{selected:a,items:r,onAddItem:i,onRemoveItems:m,onConvertItems:s}=$(),n=C(()=>[{text:"屏幕录制",type:"primary",onClick:()=>i()},{text:"批量删除",type:"primary",disabled:a.value.length<=0,onClick:()=>m(a.value)},{text:"转化选择项",type:"primary",disabled:a.value.length<=0,onClick:()=>s()}]),d=[{title:"基础信息",dataIndex:"name",width:400,render:({record:e})=>h(H,{data:e},null)},{title:"视频分辨率",dataIndex:"dpi",align:"center",render:({record:e})=>`${e.dpi.width} * ${e.dpi.height}`},{title:"视频时长(秒)",dataIndex:"duration",align:"center"},{title:"视频类型",dataIndex:"type",align:"center"},{title:"最后编辑时间",dataIndex:"lastModified",align:"center"}];return(e,t)=>(I(),w("div",P,[h(u(D),{selected:u(a),"onUpdate:selected":t[0]||(t[0]=c=>M(a)?a.value=c:null),options:{rowSelection:{type:"radio"}},data:u(r),operates:n.value,columns:d},null,8,["selected","data","operates"])]))}}),T=x(E,[["__scopeId","data-v-afe605f7"]]);export{T as default};
